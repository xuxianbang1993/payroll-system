---
document: è–ªé…¬ç®¡ç†ç³»ç»Ÿ Â· å¼€å‘ç­–ç•¥æ–‡æ¡£ï¼ˆCLAUDE.mdï¼‰
version: 2.0
date: 2026-02-11
companion: è–ªé…¬ç³»ç»Ÿ-PRD/ï¼ˆæ¨¡å—åŒ– PRD æ–‡ä»¶å¤¹ï¼‰
purpose: AI å¼€å‘è¡Œä¸ºå‡†åˆ™ + æŠ€æœ¯æ‰§è¡Œæ‰‹å†Œ
change_log:
  - v2.0: å‡çº§ä¸º CLAUDE.md æ ¼å¼ï¼Œæ–°å¢ AI è¡Œä¸ºçº¢çº¿ã€æµ‹è¯•ç­–ç•¥ã€PRD å¼ºåˆ¶éµå¾ªæœºåˆ¶
  - v1.1: ç§»é™¤ä¸ PRD é‡å¤å†…å®¹ï¼Œå¯¹é½æ¨¡å—åŒ– PRD æ–‡ä»¶å¼•ç”¨
  - v1.0: åˆå§‹ç‰ˆæœ¬
---

# è–ªé…¬ç®¡ç†ç³»ç»Ÿ Â· å¼€å‘ç­–ç•¥æ–‡æ¡£

> **æŠ€æœ¯æ ˆï¼š** Electron + React 18 + TypeScript + Vite + Ant Design + Zustand\
> **æ‰“åŒ…ç›®æ ‡ï¼š** Mac (.dmg) + Windows (.exe)\
> **äº§å“éœ€æ±‚ï¼š** è§ `è–ªé…¬ç³»ç»Ÿ-PRD/00-INDEX.md`ï¼ˆæ¨¡å—åŒ– PRD ä¸»ç´¢å¼•ï¼‰\
> **æœ¬æ–‡æ¡£æ€§è´¨ï¼š** ç­‰åŒäº `CLAUDE.md`ï¼Œæ˜¯ AI è¾…åŠ©å¼€å‘çš„è¡Œä¸ºå‡†åˆ™å’Œæ‰§è¡Œæ‰‹å†Œ

---

## â›” ä¸€ã€AI è¡Œä¸ºçº¢çº¿ï¼ˆå¿…é¡»éµå®ˆï¼‰

æœ¬ç« èŠ‚å®šä¹‰ AI åœ¨å¼€å‘è¿‡ç¨‹ä¸­**ä¸å¯è¿å**çš„è¡Œä¸ºè¾¹ç•Œã€‚

### 1.1 ä¸å¯è‡ªå¯¼è‡ªæ¼”

```
âŒ ç¦æ­¢è¡Œä¸ºï¼š
- ä¸ç¡®å®šæŸä¸ª API ç”¨æ³•æ—¶ï¼Œå‡­è®°å¿†ç¼–é€ ä»£ç 
- ä¸ç¡®å®šæŸä¸ªåº“çš„é…ç½®æ–¹å¼æ—¶ï¼Œ"çŒœæµ‹"ä¸€ä¸ªçœ‹èµ·æ¥åˆç†çš„å†™æ³•
- é‡åˆ°æŠ¥é”™æ—¶ï¼ŒæœªæŸ¥è¯å°±è¿ç»­å°è¯•å¤šç§"å¯èƒ½çš„ä¿®å¤"
- ç¼–é€ ä¸å­˜åœ¨çš„ç»„ä»¶å±æ€§ã€å‡½æ•°å‚æ•°ã€é…ç½®é¡¹

âœ… æ­£ç¡®è¡Œä¸ºï¼š
- æ‰¿è®¤"æˆ‘ä¸ç¡®å®šè¿™ä¸ª API çš„å…·ä½“ç”¨æ³•"
- é€šè¿‡ MCP è”ç½‘æœç´¢å®˜æ–¹æ–‡æ¡£
- åŸºäºå®˜æ–¹æ–‡æ¡£çš„å®é™…ç¤ºä¾‹ç¼–å†™ä»£ç 
```

### 1.2 å¿…é¡»è”ç½‘æŸ¥è¯çš„åœºæ™¯

ä»¥ä¸‹åœºæ™¯**å¿…é¡»**é€šè¿‡ MCP å·¥å…·è”ç½‘æœç´¢å®˜æ–¹æ–‡æ¡£ï¼Œä¸å¯å‡­è®°å¿†ä½œç­”ï¼š

| åœºæ™¯ | æœç´¢ç›®æ ‡ |
|------|----------|
| Electron API è°ƒç”¨ï¼ˆIPCã€çª—å£ç®¡ç†ã€èœå•ç­‰ï¼‰ | electronjs.org å®˜æ–¹æ–‡æ¡£ |
| Ant Design ç»„ä»¶ç”¨æ³•æˆ–è‡ªå®šä¹‰ä¸»é¢˜ token | ant.design å®˜æ–¹æ–‡æ¡£ |
| electron-store é…ç½®å’Œ API | npm æ–‡æ¡£ / GitHub README |
| electron-builder æ‰“åŒ…é…ç½®ï¼ˆdmg / exeï¼‰ | electron.build å®˜æ–¹æ–‡æ¡£ |
| i18next / react-i18next é…ç½® | i18next.com å®˜æ–¹æ–‡æ¡£ |
| jsPDF / html2canvas API | å¯¹åº” npm / GitHub æ–‡æ¡£ |
| xlsx (SheetJS) å¯¼å…¥å¯¼å‡º API | docs.sheetjs.com |
| Zustand persist ä¸­é—´ä»¶ | zustand GitHub æ–‡æ¡£ |
| decimal.js API | mikemcl.github.io/decimal.js |
| Vite + Electron æ•´åˆæ–¹æ¡ˆ | å¯¹åº”æ¨¡æ¿/æ’ä»¶æ–‡æ¡£ |

### 1.3 è”ç½‘å¤±è´¥æ—¶çš„å¤„ç†

```
å¦‚æœ MCP è”ç½‘æœç´¢å¤±è´¥æˆ–æ— æ³•è®¿é—®ç›®æ ‡æ–‡æ¡£ï¼š
  1. ç«‹å³åœæ­¢å½“å‰ä»»åŠ¡
  2. æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·ï¼š"è”ç½‘æœç´¢å¤±è´¥ï¼Œæ— æ³•æŸ¥è¯ [å…·ä½“å†…å®¹]ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–æ‰‹åŠ¨æä¾›æ–‡æ¡£"
  3. ä¸å¯é€€è€Œæ±‚å…¶æ¬¡åœ°"å‡­è®°å¿†å†™ä¸€ç‰ˆè¯•è¯•"
  4. ç­‰å¾…ç”¨æˆ·æä¾›æ–‡æ¡£æˆ–ç¡®è®¤åå†ç»§ç»­
```

### 1.4 PRD å¼ºåˆ¶éµå¾ª

```
æ‰€æœ‰åŠŸèƒ½å®ç°å¿…é¡»ä¸¥æ ¼å¯¹ç…§ PRD æ–‡ä»¶ï¼š
  1. å¼€å§‹ä»»ä½•æ¨¡å—å¼€å‘å‰ï¼Œå¿…é¡»å…ˆè¯»å–å¯¹åº”çš„ PRD æ–‡ä»¶
  2. å­—æ®µåã€ç±»å‹ã€è®¡ç®—å…¬å¼å¿…é¡»ä¸ PRD 01-data-model.md å®Œå…¨ä¸€è‡´
  3. UI ç»“æ„å¿…é¡»ä¸ PRD ä¸­æè¿°çš„é¡µé¢å¸ƒå±€ä¸€è‡´
  4. ä¸å¯"ä¼˜åŒ–"æˆ–"æ”¹è¿›" PRD ä¸­æ˜ç¡®å®šä¹‰çš„ä¸šåŠ¡é€»è¾‘ï¼ˆå¦‚æœ‰å»ºè®®ï¼Œå…ˆæå‡ºå†ç­‰ç¡®è®¤ï¼‰
  5. æ¯å®Œæˆä¸€ä¸ªåŠŸèƒ½ï¼Œå¯¹ç…§ PRD å¯¹åº”ç« èŠ‚é€é¡¹è‡ªæ£€
```

### 1.5 ä»£ç è´¨é‡çº¢çº¿

```
- å•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡ 200 è¡Œï¼ˆè¶…å‡ºå¿…é¡»æ‹†åˆ†ï¼‰
- æ‰€æœ‰ç”¨æˆ·å¯è§æ–‡å­—å¿…é¡»èµ° i18nï¼ˆt('key')ï¼‰ï¼Œç¦æ­¢ç¡¬ç¼–ç ä¸­æ–‡
- é‡‘é¢è®¡ç®—å¿…é¡»ä½¿ç”¨ decimal.jsï¼Œç¦æ­¢åŸç”Ÿæµ®ç‚¹è¿ç®—
- TypeScript strict æ¨¡å¼ï¼Œç¦æ­¢ any ç±»å‹ï¼ˆæå°‘æ•°å¿…è¦åœºæ™¯éœ€æ³¨é‡Šè¯´æ˜ç†ç”±ï¼‰
- æ¯ä¸ª service å‡½æ•°å¿…é¡»æ˜¯çº¯å‡½æ•°ï¼ˆé›¶å‰¯ä½œç”¨ï¼Œå¯ç‹¬ç«‹æµ‹è¯•ï¼‰
- ç»„ä»¶ props å¿…é¡»æœ‰æ˜ç¡®çš„ TypeScript æ¥å£å®šä¹‰
```

---

## äºŒã€æŠ€æœ¯é€‰å‹

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬è¦æ±‚ | æ–‡æ¡£åœ°å€ï¼ˆè”ç½‘æŸ¥è¯ç”¨ï¼‰ |
|------|----------|:-------:|----------------------|
| æ¡Œé¢å£³ | Electron | 33+ | electronjs.org |
| å‰ç«¯æ¡†æ¶ | React + TypeScript | 18.x | react.dev |
| æ„å»ºå·¥å…· | Vite | 6.x | vite.dev |
| UI ç»„ä»¶åº“ | Ant Design | 5.x | ant.design |
| çŠ¶æ€ç®¡ç† | Zustand | 5.x | github.com/pmndrs/zustand |
| å›½é™…åŒ– | i18next + react-i18next | 24.x | i18next.com |
| æ•°æ®æŒä¹…åŒ– | electron-store | 10.x | github.com/sindresorhus/electron-store |
| é‡‘é¢è®¡ç®— | decimal.js | 10.x | mikemcl.github.io/decimal.js |
| PDF å¯¼å‡º | jsPDF + html2canvas | â€” | â€” |
| Excel | xlsx (SheetJS) | â€” | docs.sheetjs.com |
| æ‰“åŒ…å·¥å…· | electron-builder | 25.x | electron.build |
| å•å…ƒæµ‹è¯• | Vitest | 3.x | vitest.dev |
| ç»„ä»¶æµ‹è¯• | React Testing Library | 16.x | testing-library.com |
| E2E æµ‹è¯• | Playwright | 1.5x | playwright.dev |

> âš ï¸ ç‰ˆæœ¬å·ä»…ä¸ºå‚è€ƒåŒºé—´ã€‚å®é™…å®‰è£…æ—¶ä»¥ `npm info <package> version` è¿”å›çš„æœ€æ–°ç¨³å®šç‰ˆä¸ºå‡†ï¼Œå¦‚æœ‰å¤§ç‰ˆæœ¬å·®å¼‚éœ€è”ç½‘ç¡®è®¤ breaking changesã€‚

---

## ä¸‰ã€é¡¹ç›®ç»“æ„ Ã— PRD æ¨¡å—æ˜ å°„

```
payroll-app/
â”œâ”€â”€ electron/
â”‚   â”œâ”€â”€ main.ts                        # ä¸»è¿›ç¨‹å…¥å£
â”‚   â””â”€â”€ preload.ts                     # é¢„åŠ è½½è„šæœ¬
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.tsx                       # React å…¥å£
â”‚   â”œâ”€â”€ App.tsx                        # æ ¹ç»„ä»¶ + è·¯ç”±
â”‚   â”‚
â”‚   â”œâ”€â”€ layouts/
â”‚   â”‚   â””â”€â”€ AppLayout.tsx              # â† PRD: 02-ui-layout.md
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/                         # â† PRD: å„æ¨¡å—æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ settings/
â”‚   â”‚   â”‚   â”œâ”€â”€ OrgSettingsPage.tsx     # â† PRD: 03-mod-settings.md Â§1
â”‚   â”‚   â”‚   â”œâ”€â”€ SocialConfigPage.tsx   # â† PRD: 03-mod-settings.md Â§2
â”‚   â”‚   â”‚   â””â”€â”€ CompanyPage.tsx        # â† PRD: 03-mod-settings.md Â§3
â”‚   â”‚   â”œâ”€â”€ employee/
â”‚   â”‚   â”‚   â”œâ”€â”€ EmployeePage.tsx       # â† PRD: 04-mod-employee.md Â§1
â”‚   â”‚   â”‚   â””â”€â”€ ImportExportPage.tsx   # â† PRD: 07-import-export.md
â”‚   â”‚   â”œâ”€â”€ payroll/
â”‚   â”‚   â”‚   â”œâ”€â”€ PayrollByEmpPage.tsx   # â† PRD: 05-mod-payroll.md Â§ä¸€
â”‚   â”‚   â”‚   â””â”€â”€ PayrollDetailPage.tsx  # â† PRD: 05-mod-payroll.md Â§ä¸€.4
â”‚   â”‚   â”œâ”€â”€ voucher/
â”‚   â”‚   â”‚   â””â”€â”€ VoucherPage.tsx        # â† PRD: 06-mod-voucher.md
â”‚   â”‚   â””â”€â”€ data/
â”‚   â”‚       â”œâ”€â”€ BackupPage.tsx         # â† PRD: 08-data-management.md
â”‚   â”‚       â””â”€â”€ StoragePage.tsx        # â† PRD: 08-data-management.md Â§4
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ EmployeeForm.tsx
â”‚   â”‚   â”œâ”€â”€ EmployeeTable.tsx
â”‚   â”‚   â”œâ”€â”€ EmployeeDetail.tsx
â”‚   â”‚   â”œâ”€â”€ SocialConfigForm.tsx
â”‚   â”‚   â”œâ”€â”€ CompanyManager.tsx
â”‚   â”‚   â”œâ”€â”€ PayCard.tsx
â”‚   â”‚   â”œâ”€â”€ PaySlip.tsx
â”‚   â”‚   â”œâ”€â”€ VoucherCard.tsx
â”‚   â”‚   â”œâ”€â”€ MonthPicker.tsx
â”‚   â”‚   â”œâ”€â”€ StatsRow.tsx
â”‚   â”‚   â””â”€â”€ ImportConflictModal.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                      # çº¯ä¸šåŠ¡é€»è¾‘ï¼ˆé›¶ UI ä¾èµ–ï¼‰
â”‚   â”‚   â”œâ”€â”€ calculator.ts              # â† PRD: 05-mod-payroll.md Â§äºŒ
â”‚   â”‚   â”œâ”€â”€ voucherGenerator.ts        # â† PRD: 06-mod-voucher.md Â§2-8
â”‚   â”‚   â””â”€â”€ aggregator.ts             # â† PRD: 05-mod-payroll.md Â§äºŒ.2
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â”œâ”€â”€ settingsStore.ts
â”‚   â”‚   â”œâ”€â”€ employeeStore.ts
â”‚   â”‚   â”œâ”€â”€ payrollStore.ts
â”‚   â”‚   â””â”€â”€ uiStore.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ decimal.ts                 # decimal.js å°è£…ï¼ˆå¤ç”¨ HK Accountingï¼‰
â”‚   â”‚   â”œâ”€â”€ storage.ts                 # electron-store å°è£…
â”‚   â”‚   â”œâ”€â”€ migrator.ts               # â† PRD: 08-data-management.md Â§5
â”‚   â”‚   â”œâ”€â”€ exportPdf.ts              # â† PRD: 07-import-export.md Â§4
â”‚   â”‚   â”œâ”€â”€ exportExcel.ts            # â† PRD: 07-import-export.md Â§3
â”‚   â”‚   â”œâ”€â”€ importExcel.ts            # â† PRD: 07-import-export.md Â§2
â”‚   â”‚   â””â”€â”€ format.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ i18n/                          # â† PRD: 09-nonfunctional.md Â§4
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ zh-HK.json
â”‚   â”‚   â”œâ”€â”€ zh-CN.json
â”‚   â”‚   â””â”€â”€ en.json
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                         # â† PRD: 01-data-model.md
â”‚   â”‚   â”œâ”€â”€ employee.ts
â”‚   â”‚   â”œâ”€â”€ payroll.ts
â”‚   â”‚   â”œâ”€â”€ voucher.ts
â”‚   â”‚   â””â”€â”€ settings.ts
â”‚   â”‚
â”‚   â””â”€â”€ assets/styles/
â”‚       â”œâ”€â”€ variables.css
â”‚       â””â”€â”€ global.css
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ calculator.test.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ voucherGenerator.test.ts
â”‚   â”‚   â”‚   â””â”€â”€ aggregator.test.ts
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â”œâ”€â”€ decimal.test.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ migrator.test.ts
â”‚   â”‚   â”‚   â””â”€â”€ format.test.ts
â”‚   â”‚   â””â”€â”€ stores/
â”‚   â”‚       â”œâ”€â”€ settingsStore.test.ts
â”‚   â”‚       â”œâ”€â”€ employeeStore.test.ts
â”‚   â”‚       â””â”€â”€ payrollStore.test.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ component/
â”‚   â”‚   â”œâ”€â”€ EmployeeForm.test.tsx
â”‚   â”‚   â”œâ”€â”€ PayCard.test.tsx
â”‚   â”‚   â”œâ”€â”€ VoucherCard.test.tsx
â”‚   â”‚   â””â”€â”€ SocialConfigForm.test.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ e2e/
â”‚   â”‚   â”œâ”€â”€ payroll-flow.spec.ts
â”‚   â”‚   â”œâ”€â”€ voucher-flow.spec.ts
â”‚   â”‚   â”œâ”€â”€ import-export.spec.ts
â”‚   â”‚   â””â”€â”€ backup-restore.spec.ts
â”‚   â”‚
â”‚   â””â”€â”€ fixtures/
â”‚       â”œâ”€â”€ employees.json
â”‚       â”œâ”€â”€ social-config.json
â”‚       â””â”€â”€ legacy-backup.json
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ vitest.config.ts
â”œâ”€â”€ playwright.config.ts
â”œâ”€â”€ electron-builder.yml
â”œâ”€â”€ tsconfig.json
â””â”€â”€ README.md
```

### ä»£ç å±‚çº§ä¾èµ–å…³ç³»

```
types/           â† PRD: 01-data-model.mdï¼ˆå…¬å…±ç±»å‹ï¼‰
  â†“
services/        â† PRD: 05 + 06ï¼ˆçº¯å‡½æ•°ï¼Œå•å…ƒæµ‹è¯•è¦†ç›–ï¼‰
  â†“
stores/          â† è°ƒç”¨ servicesï¼ˆstore æµ‹è¯•è¦†ç›–ï¼‰
  â†“
components/      â† æ¶ˆè´¹ storesï¼ˆç»„ä»¶æµ‹è¯•è¦†ç›–ï¼‰
  â†“
pages/           â† ç»„åˆ componentsï¼ˆE2E æµ‹è¯•è¦†ç›–ï¼‰
  â†“
App.tsx â†’ electron/main.ts
```

---

## å››ã€æµ‹è¯•ç­–ç•¥

### 4.1 æµ‹è¯•åˆ†å±‚

| å±‚çº§ | å·¥å…· | è¦†ç›–èŒƒå›´ | è¿è¡Œæ—¶æœº |
|------|------|----------|----------|
| **å•å…ƒæµ‹è¯•** | Vitest | services/ã€utils/ã€stores/ | æ¯æ¬¡æäº¤å‰ |
| **ç»„ä»¶æµ‹è¯•** | Vitest + React Testing Library | components/ äº¤äº’é€»è¾‘ | æ¯æ¬¡æäº¤å‰ |
| **E2E æµ‹è¯•** | Playwright | å®Œæ•´ä¸šåŠ¡æµç¨‹ | æ¯ä¸ª Phase å®Œæˆå |

### 4.2 å•å…ƒæµ‹è¯•è¦æ±‚ï¼ˆservices/ â€” æœ€é«˜ä¼˜å…ˆçº§ï¼‰

`services/` æ˜¯æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå¿…é¡» 100% è¦†ç›–ã€‚

#### calculator.test.ts â€” å·¥èµ„è®¡ç®—

```
å¿…é¡»è¦†ç›–çš„åœºæ™¯ï¼ˆå¯¹ç…§ PRD 05-mod-payroll.md Â§äºŒï¼‰ï¼š

âœ… åŸºç¡€è®¡ç®—
  - çº¯åŸºæœ¬å·¥èµ„ï¼ˆæ— ç»©æ•ˆã€æ— ç¤¾ä¿ã€æ— ç¼ºå‹¤ï¼‰â†’ netPay = baseSalary + subsidy
  - å«ç»©æ•ˆå…¨é¡¹ â†’ éªŒè¯ fullGrossPay
  - å«ç¼ºå‹¤æ‰£æ¬¾ â†’ hourlyRate = base / 21.75 / 8
  - å«å…¶ä»–è°ƒæ•´ï¼ˆæ­£æ•° / è´Ÿæ•°ï¼‰

âœ… ç¤¾ä¿è®¡ç®—
  - hasSocial = true â†’ 6 é™©å•ä½ + 3 é™©ä¸ªäººå…¨éƒ¨æ­£ç¡®
  - hasSocial = false â†’ æ‰€æœ‰ç¤¾ä¿é¡¹ = 0
  - hasLocalPension = false â†’ cLocalPension = 0ï¼Œå…¶ä½™æ­£å¸¸
  - æ¯é¡¹å•ç‹¬å››èˆäº”å…¥åˆ° 2 ä½å°æ•°åå†æ±‚å’Œ

âœ… å…¬ç§¯é‡‘
  - fundAmount > 0 â†’ cFund = wFund = fundAmount
  - fundAmount = 0 â†’ cFund = wFund = 0

âœ… å®å‘å·¥èµ„
  - netPay = grossPay - wSocial - wFund - tax

âœ… ç²¾åº¦
  - æ„é€ ç²¾åº¦æ•æ„Ÿæ•°æ®ï¼ŒéªŒè¯ decimal.js æ­£ç¡®æ€§
```

#### voucherGenerator.test.ts â€” å‡­è¯ç”Ÿæˆ

```
å¯¹ç…§ PRD 06-mod-voucher.md Â§2-8ï¼š

âœ… å‡­è¯ â‘ ï¼šå€Ÿæ–¹æŒ‰é”€å”®/ç®¡ç†åˆ†ç±»ã€è´·æ–¹æ±‡æ€»ã€ä»£æ‰£åˆ†å½•ã€å€Ÿè´·å¹³è¡¡
âœ… å‡­è¯ â‘¡â‘¢â‘£ï¼šå„è‡ªå€Ÿè´·å¹³è¡¡ã€é‡‘é¢ä¸º 0 æ—¶æ•´å¼ ä¸ç”Ÿæˆ
âœ… å‡­è¯ â‘¤ï¼šå«/ä¸å«ç¼ºå‹¤æ‰£æ¬¾ä¸¤ç§åœºæ™¯
âœ… ä½™é¢æ ¡éªŒï¼š5 å¼ å‡­è¯å®Œæˆå åº”ä»˜èŒå·¥è–ªé…¬-äººå‘˜å·¥èµ„ = 0
```

#### aggregator.test.ts â€” æ±‡æ€»

```
âœ… æŒ‰ type åˆ†ç±»ï¼ˆé”€å”® / ç®¡ç†ï¼‰
âœ… å…¨å‘˜åˆè®¡ = é”€å”® + ç®¡ç†
âœ… ç²¾åº¦è§„åˆ™ï¼šå…ˆç´¯åŠ åŸå§‹å€¼ï¼Œæœ€åç»Ÿä¸€å››èˆäº”å…¥
âœ… æŒ‰å…¬å¸ä¸»ä½“ç­›é€‰
```

### 4.3 ç»„ä»¶æµ‹è¯•è¦æ±‚

```
EmployeeForm     â€” å¿…å¡«æ ¡éªŒã€æäº¤æ•°æ®æ­£ç¡®æ€§ã€é»˜è®¤å€¼
PayCard          â€” ç”Ÿæˆ/æœªç”ŸæˆçŠ¶æ€åˆ‡æ¢ã€è®¡ç®—ç»“æœæ˜¾ç¤º
VoucherCard      â€” å€Ÿè´·å¹³è¡¡æ ‡è¯†ã€é›¶å€¼è¡Œéšè—
SocialConfigForm â€” ä¿®æ”¹åç¤ºä¾‹å®æ—¶æ›´æ–°
```

### 4.4 E2E æµ‹è¯•è¦æ±‚

```
payroll-flow.spec.ts    â€” åˆ›å»ºå‘˜å·¥ â†’ è¾“å…¥å˜é‡ â†’ ç”Ÿæˆå·¥èµ„æ¡ â†’ éªŒè¯é‡‘é¢
voucher-flow.spec.ts    â€” ç”Ÿæˆå·¥èµ„æ¡ â†’ 5 å¼ å‡­è¯ â†’ å€Ÿè´·å¹³è¡¡ â†’ ç­›é€‰
import-export.spec.ts   â€” ä¸‹è½½æ¨¡æ¿ â†’ å¯¼å…¥ â†’ å†²çªå¤„ç† â†’ éªŒè¯
backup-restore.spec.ts  â€” æ·»åŠ æ•°æ® â†’ å¤‡ä»½ â†’ æ¸…ç©º â†’ æ¢å¤ â†’ éªŒè¯ä¸€è‡´
```

### 4.5 æµ‹è¯•æ•°æ®ï¼ˆtests/fixtures/ï¼‰

```
employees.json â€” è‡³å°‘ 4 äººï¼š
  - 2 åé”€å”®ï¼ˆhasSocial=true / false å„ 1ï¼‰
  - 2 åç®¡ç†ï¼ˆhasLocalPension=true / false å„ 1ï¼‰
  - åˆ†å±ä¸åŒå…¬å¸ä¸»ä½“

social-config.json â€” ä½¿ç”¨ PRD 01-data-model.md é»˜è®¤å€¼

legacy-backup.json â€” åŸç³»ç»ŸçœŸå®å¤‡ä»½ï¼ˆå…¼å®¹æ€§æµ‹è¯•ï¼‰
```

### 4.6 æµ‹è¯•å‘½ä»¤

```bash
npm run test              # vitest runï¼ˆå•å…ƒ + ç»„ä»¶ï¼‰
npm run test:watch        # vitest --watch
npm run test:coverage     # vitest run --coverage
npm run test:e2e          # playwright test
npm run test:all          # vitest run && playwright test
```

---

## äº”ã€ä¸åŸç³»ç»Ÿçš„å…³é”®å·®å¼‚

| ç»´åº¦ | åŸç³»ç»Ÿ | é‡æ„å |
|------|--------|--------|
| ä»£ç ç»„ç»‡ | å•æ–‡ä»¶ 2304 è¡Œ | ~30 ä¸ªæ–‡ä»¶ï¼Œå•ä¸ª < 200 è¡Œ |
| é‡‘é¢è®¡ç®— | `Math.round(n*100)/100` | `decimal.js` ç²¾ç¡®è®¡ç®— |
| æ•°æ®å­˜å‚¨ | localStorageï¼ˆ5MBï¼‰ | electron-storeï¼ˆJSON æ–‡ä»¶ï¼‰ |
| ç±»å‹å®‰å…¨ | æ—  | TypeScript strict |
| çŠ¶æ€ç®¡ç† | å…¨å±€å˜é‡ | Zustand å“åº”å¼ |
| UI æ¸²æŸ“ | innerHTML æ‹¼æ¥ | React + Ant Design |
| å¤šè¯­è¨€ | ç¡¬ç¼–ç ä¸­æ–‡ | i18next ä¸‰è¯­ |
| æµ‹è¯• | æ—  | å•å…ƒ + ç»„ä»¶ + E2E ä¸‰å±‚ |
| éƒ¨ç½² | æ‰“å¼€ HTML | åŒå‡»å®‰è£…æ¡Œé¢åº”ç”¨ |

---

## å…­ã€å¯å¤ç”¨ HK Accounting çš„ä»£ç 

| æ–‡ä»¶ | æ¥æº | ç”¨é€” |
|------|------|------|
| `decimal.ts` | HK Accounting `src/lib/decimal.ts` | é‡‘é¢è®¡ç®— |
| CSS å˜é‡ä½“ç³» | HK Accounting ä¸»é¢˜è‰² + é—´è· | è§†è§‰ä¸€è‡´ |
| Zustand persist | HK Accounting companyStore æ¨¡å¼ | çŠ¶æ€æŒä¹…åŒ– |

---

## ä¸ƒã€å·²ç¡®è®¤å†³ç­–

| äº‹é¡¹ | å†³ç­– | å½±å“ |
|------|------|------|
| **UI é£æ ¼** | âœ… å…¨æ–°è®¾è®¡ | P0 å‡ºè®¾è®¡è§„èŒƒ |
| **å›½é™…åŒ–** | âœ… ä¸‰è¯­ | P0 å®Œæˆæ¡†æ¶ |
| **æ—§æ•°æ®å…¼å®¹** | âœ… æ”¯æŒå¯¼å…¥ï¼ˆPRD `08 Â§5`ï¼‰ | P1 å®Œæˆ |
| **æµ‹è¯•** | âœ… ä¸‰å±‚ï¼ˆå•å…ƒ + ç»„ä»¶ + E2Eï¼‰ | å„ Phase é›†æˆ |
| **åº”ç”¨åç§°** | âš ï¸ å¾…ç¡®è®¤ | æ‰“åŒ…å‰ç¡®å®š |

---

## å…«ã€å¼€å‘é˜¶æ®µ

### é˜¶æ®µæ‰§è¡Œè§„èŒƒï¼ˆæ¯ä¸ª Phase é€šç”¨ï¼‰

```
Phase å¼€å§‹å‰ï¼š
  1. è¯»å–æœ¬æ–‡æ¡£å¯¹åº”é˜¶æ®µçš„ã€Œéœ€è¯» PRDã€åˆ—è¡¨
  2. ç¡®è®¤å‰ç½® Phase å·²å®Œæˆä¸”æµ‹è¯•é€šè¿‡

Phase æ‰§è¡Œä¸­ï¼š
  3. ä¸¥æ ¼æŒ‰ PRD å­—æ®µåã€ç±»å‹ã€å…¬å¼å®ç°
  4. é‡åˆ°ä¸ç¡®å®šçš„æŠ€æœ¯ç»†èŠ‚ â†’ MCP è”ç½‘æŸ¥å®˜æ–¹æ–‡æ¡£
  5. è”ç½‘å¤±è´¥ â†’ ç«‹å³åœæ­¢ï¼Œå‘ŠçŸ¥ç”¨æˆ·
  6. æ¯å®Œæˆä¸€ä¸ªä»»åŠ¡ â†’ å¯¹ç…§ PRD è‡ªæ£€
  7. ä¸šåŠ¡é€»è¾‘ä»£ç ï¼ˆservices/ï¼‰å†™å®Œåç«‹å³å†™å¯¹åº”å•å…ƒæµ‹è¯•

Phase å®Œæˆåï¼š
  8. è¿è¡Œ npm run testï¼ˆå•å…ƒ + ç»„ä»¶ï¼‰
  9. è¿è¡Œå¯¹åº” E2E æµ‹è¯•
  10. å…¨éƒ¨é€šè¿‡åæ‰å¯è¿›å…¥ä¸‹ä¸€é˜¶æ®µ
```

---

### P0ï¼šåŸºç¡€æ¡†æ¶ + è®¾è®¡ç³»ç»Ÿ + æµ‹è¯•åŸºå»ºï¼ˆç¬¬ 1 å¤©ï¼‰

> ğŸ“„ éœ€è¯» PRDï¼š`00-INDEX.md` + `01-data-model.md` + `02-ui-layout.md` + `09-nonfunctional.md Â§4`\
> ğŸ” éœ€è”ç½‘æŸ¥è¯ï¼šVite+Electron æ•´åˆã€Ant Design 5.x ä¸»é¢˜ tokenã€Vitest é…ç½®

| ä»»åŠ¡ | äº§å‡º |
|------|------|
| åˆå§‹åŒ– Vite + React + TS + Electron é¡¹ç›® | `npm run dev` å¯åŠ¨çª—å£ |
| UI è®¾è®¡è§„èŒƒ | `variables.css` + è®¾è®¡æ–‡æ¡£ |
| Ant Design ä¸»é¢˜ + Zustand é…ç½® | æ ·å¼ç³»ç»Ÿå°±ç»ª |
| i18next é…ç½® + ä¸‰è¯­è¨€åŒ…éª¨æ¶ | å›½é™…åŒ–å°±ç»ª |
| AppLayout + ä¾§è¾¹æ å¯¼èˆª + è·¯ç”± | å¯¼èˆªå¯åˆ‡æ¢ |
| electron-store é…ç½® | æŒä¹…åŒ–å°±ç»ª |
| å®šä¹‰ TypeScript ç±»å‹ï¼ˆ`types/`ï¼‰ | ç±»å‹å…¨éƒ¨å®Œæˆ |
| **Vitest + RTL + Playwright é…ç½®** | **æµ‹è¯•æ¡†æ¶å°±ç»ª** |
| **åˆ›å»º `tests/fixtures/`** | **æµ‹è¯•æ•°æ®å°±ç»ª** |

### P1ï¼šåŸºç¡€è®¾ç½® + äººå‘˜ç®¡ç† + æ•°æ®ç®¡ç†ï¼ˆç¬¬ 2-3 å¤©ï¼‰

> ğŸ“„ éœ€è¯» PRDï¼š`01-data-model.md` + `03-mod-settings.md` + `04-mod-employee.md` + `07-import-export.md` + `08-data-management.md`\
> ğŸ” éœ€è”ç½‘æŸ¥è¯ï¼šSheetJS å¯¼å…¥ APIã€electron-store API

| ä»»åŠ¡ | äº§å‡º | PRD | æµ‹è¯• |
|------|------|-----|------|
| settingsStore + OrgSettingsPage | ç»„ç»‡åç§°ã€ç»Ÿè®¡æ¦‚è§ˆ | `03 Â§1` | store å•å…ƒ |
| SocialConfigPage | ç¤¾ä¿é…ç½®è¡¨å• | `03 Â§2` | ç»„ä»¶æµ‹è¯• |
| CompanyPage | å…¬å¸ä¸»ä½“ CRUD | `03 Â§3` | store å•å…ƒ |
| employeeStore + EmployeePage | å‘˜å·¥ CRUD | `04 Â§1` | store å•å…ƒ |
| EmployeeForm + EmployeeDetail | å¼¹çª—ã€è¯¦æƒ… | `04 Â§1` | ç»„ä»¶æµ‹è¯• |
| ImportExportPage | Excel å¯¼å…¥å¯¼å‡º | `07` | E2E |
| BackupPage | å¤‡ä»½/æ¢å¤/æ¸…ç©º | `08 Â§1-3` | E2E |
| StoragePage | å­˜å‚¨ä¿¡æ¯ | `08 Â§4` | â€” |
| migrator.ts | æ—§æ•°æ®å¯¼å…¥ | `08 Â§5` | å•å…ƒæµ‹è¯• |

âœ… **P1 å®Œæˆé—¨æ§›**ï¼š`npm run test` é€šè¿‡ + `backup-restore.spec.ts` é€šè¿‡

### P2ï¼šè–ªèµ„æ ¸ç®—ï¼ˆç¬¬ 3-4 å¤©ï¼‰

> ğŸ“„ éœ€è¯» PRDï¼š`01-data-model.md` + `05-mod-payroll.md`\
> ğŸ” éœ€è”ç½‘æŸ¥è¯ï¼šjsPDF ä¸­æ–‡å­—ä½“æ–¹æ¡ˆ

| ä»»åŠ¡ | äº§å‡º | PRD | æµ‹è¯• |
|------|------|-----|------|
| **calculator.ts** | ğŸ”‘ æ ¸å¿ƒè®¡ç®— | `05 Â§äºŒ` | **calculator.test.ts** |
| payrollStore + PayrollByEmpPage | è–ªèµ„é¡µé¢ | `05 Â§ä¸€` | store å•å…ƒ |
| PayCard | è–ªèµ„å¡ç‰‡ | `05 Â§ä¸€.3` | ç»„ä»¶æµ‹è¯• |
| PaySlip | å·¥èµ„æ¡é¢„è§ˆ | `05 Â§ä¸€.3` | â€” |
| PayrollDetailPage | 28 åˆ—æ˜ç»†è¡¨ | `05 Â§ä¸€.4` | â€” |
| PDF æ‰¹é‡å¯¼å‡º | å…¨å‘˜å¯¼å‡º | `07 Â§3-4` | â€” |

âœ… **P2 å®Œæˆé—¨æ§›**ï¼š`calculator.test.ts` é€šè¿‡ + `payroll-flow.spec.ts` é€šè¿‡

### P3ï¼šä¼šè®¡å‡­è¯ï¼ˆç¬¬ 4-5 å¤©ï¼‰

> ğŸ“„ éœ€è¯» PRDï¼š`01-data-model.md` + `06-mod-voucher.md`

| ä»»åŠ¡ | äº§å‡º | PRD | æµ‹è¯• |
|------|------|-----|------|
| **voucherGenerator.ts** | ğŸ”‘ 5 å¼ å‡­è¯ | `06 Â§2-6` | **voucherGenerator.test.ts** |
| **aggregator.ts** | å…¨å‘˜æ±‡æ€» | `05 Â§äºŒ.2` | **aggregator.test.ts** |
| VoucherCard | å‡­è¯å¡ç‰‡ | `06 Â§7` | ç»„ä»¶æµ‹è¯• |
| VoucherPage | å‡­è¯é¡µé¢ + ç­›é€‰ | `06 Â§1` | â€” |
| å‡­è¯ CSV å¯¼å‡º | å¯¼å‡º | `07 Â§3` | â€” |
| ä½™é¢æ ¡éªŒ | åº”ä»˜è–ªé…¬ = 0 | `06 Â§8` | å«åœ¨ voucher æµ‹è¯•ä¸­ |

âœ… **P3 å®Œæˆé—¨æ§›**ï¼š`voucherGenerator.test.ts` é€šè¿‡ + `voucher-flow.spec.ts` é€šè¿‡

### P4ï¼šæ‰“åŒ… + å…¨é‡æµ‹è¯•ï¼ˆç¬¬ 5 å¤©ï¼‰

> ğŸ“„ éœ€è¯» PRDï¼š`09-nonfunctional.md` + `10-acceptance.md`\
> ğŸ” éœ€è”ç½‘æŸ¥è¯ï¼šelectron-builder dmg/exe ç­¾å

| ä»»åŠ¡ | äº§å‡º |
|------|------|
| electron-builder é…ç½® | .dmg + .exe |
| åº”ç”¨å›¾æ ‡ | è‡ªå®šä¹‰å›¾æ ‡ |
| ä¸‰è¯­è¨€åŒ…å®Œå–„ | ~200 key ç¿»è¯‘å®Œæˆ |
| **`npm run test:all` å…¨é‡æµ‹è¯•** | **å…¨éƒ¨é€šè¿‡** |
| **`10-acceptance.md` é€é¡¹éªŒæ”¶** | **A-01~A-11, B-01~B-04 å…¨ âœ“** |

---

### å¼€å‘é˜¶æ®µ Ã— PRD Ã— æµ‹è¯• æ€»è§ˆ

| é˜¶æ®µ | éœ€åŠ è½½ PRD | è¡Œæ•° | å…³é”®æµ‹è¯• | å®Œæˆé—¨æ§› |
|:----:|-----------|:----:|----------|----------|
| P0 | 00+01+02+09 | ~380 | å†’çƒŸæµ‹è¯• | æ¡†æ¶å¯è¿è¡Œ |
| P1 | 01+03+04+07+08 | ~400 | store + backup E2E | `npm test` âœ“ |
| P2 | 01+05 | ~300 | **calculator å•å…ƒ** | calculator âœ“ + E2E âœ“ |
| P3 | 01+06 | ~370 | **voucher å•å…ƒ** | voucher âœ“ + E2E âœ“ |
| P4 | 09+10 | ~75 | **å…¨é‡** | `test:all` âœ“ + éªŒæ”¶ âœ“ |

---

> **æ–‡æ¡£å®šä½æ€»ç»“**
>
> æœ¬æ–‡æ¡£ = é¡¹ç›®çš„ `CLAUDE.md`ï¼Œæ˜¯ AI è¾…åŠ©å¼€å‘çš„å”¯ä¸€è¡Œä¸ºå‡†åˆ™ï¼š
> - **ç¬¬ä¸€ç« **ï¼šæ¯æ¬¡å¯¹è¯å¼€å§‹æ—¶å›é¡¾ï¼ˆè¡Œä¸ºçº¢çº¿ï¼‰
> - **ç¬¬ä¸‰ç« **ï¼šåˆ›å»ºæ–‡ä»¶æ—¶å‚ç…§ï¼ˆé¡¹ç›®ç»“æ„ï¼‰
> - **ç¬¬å››ç« **ï¼šå†™å®Œä»£ç åç«‹å³å†™æµ‹è¯•ï¼ˆæµ‹è¯•ç­–ç•¥ï¼‰
> - **ç¬¬å…«ç« **ï¼šæŒ‰ Phase æ‰§è¡Œï¼Œæµ‹è¯•é€šè¿‡æ‰èƒ½ç»§ç»­ï¼ˆå¼€å‘é˜¶æ®µï¼‰
>
> é…åˆ `è–ªé…¬ç³»ç»Ÿ-PRD/` æ–‡ä»¶å¤¹ä½¿ç”¨ï¼šæœ¬æ–‡æ¡£å®šä¹‰ã€Œæ€ä¹ˆåšã€ï¼ŒPRD å®šä¹‰ã€Œåšä»€ä¹ˆã€ã€‚